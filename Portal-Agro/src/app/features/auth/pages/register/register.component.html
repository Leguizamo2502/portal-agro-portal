<div class="container-fluid vh-100 fondo-auth">
  <div class="row h-100">
    <!-- Columna izquierda -->
    <div class="col-md-6 d-none d-md-flex flex-column justify-content-center align-items-center text-white">
      <img src="logos/logo.png" alt="Logo" class="mb-4" style="width: 200px;">
      <h2 class="text-center">Portal Agro-comercial del Huila</h2>
    </div>

    <!-- Columna derecha -->
    <div class="col-md-6 d-flex justify-content-center align-items-center">
      <div class="w-75 w-md-75 w-lg-50 p-4 shadow bg-white formaForm">
        <h3 class="text-center mb-3 titleForm">Regístrate</h3>
        <div class="mt-2 text-center">
          ¿Ya tienes cuenta?
          <a routerLink="../login" class="text-primary" style="cursor: pointer;">Inicia Sesión</a>
        </div>

        <!-- Indicador simple de progreso -->
        <!-- <div class="d-flex justify-content-center gap-2 my-3">
          <span [class.fw-bold]="currentStep === 1">1. Credenciales</span>
          <span>•</span>
          <span [class.fw-bold]="currentStep === 2">2. Datos básicos</span>
          <span>•</span>
          <span [class.fw-bold]="currentStep === 3">3. Contacto</span>
        </div> -->

        <!-- Paso 1: Credenciales -->
        <!-- Paso 1: Credenciales -->
        <form [formGroup]="credentialsForm" *ngIf="currentStep === 1">
          <div class="mb-2">
            <label for="email" class="form-label">Correo Electrónico</label>
            <input id="email" type="email" class="form-control input-custom" formControlName="email"
              placeholder="Correo Electrónico">
            <div class="text-danger small"
              *ngIf="credentialsForm.get('email')?.invalid && credentialsForm.get('email')?.touched">
              {{ getErrorMessage(credentialsForm, 'email') }}
            </div>
          </div>

          <div class="mb-2">
            <label for="password" class="form-label">Contraseña</label>
            <input id="password" type="password" class="form-control input-custom" formControlName="password"
              placeholder="Contraseña">
            <div class="text-danger small"
              *ngIf="credentialsForm.get('password')?.invalid && credentialsForm.get('password')?.touched">
              {{ getErrorMessage(credentialsForm, 'password') }}
            </div>
          </div>

          <div class="mb-2">
            <label for="confirmPassword" class="form-label">Confirmar Contraseña</label>
            <input id="confirmPassword" type="password" class="form-control input-custom"
              formControlName="confirmPassword" placeholder="Confirmar Contraseña">
            <div class="text-danger small" *ngIf="(credentialsForm.get('confirmPassword')?.touched || credentialsForm.get('password')?.touched) 
                 && credentialsForm.hasError('passwordMismatch')">
              {{ getErrorMessage(credentialsForm, 'confirmPassword') }}
            </div>
          </div>

          <div class="d-grid mt-3">
            <button type="button" class="btn btn-success btn-custom" (click)="nextStep()"
              [disabled]="credentialsForm.invalid">
              Siguiente
            </button>
          </div>
        </form>


        <!-- Paso 2: Datos básicos -->
        <form [formGroup]="basicForm" *ngIf="currentStep === 2">
          <div class="mb-2">
            <label for="firstName" class="form-label">Nombre</label>
            <input id="firstName" type="text" class="form-control input-custom" formControlName="firstName"
              placeholder="Nombre">
            <div class="text-danger small"
              *ngIf="basicForm.get('firstName')?.invalid && basicForm.get('firstName')?.touched">
              {{ getErrorMessage(basicForm, 'firstName') }}
            </div>
          </div>

          <div class="mb-2">
            <label for="lastName" class="form-label">Apellido</label>
            <input id="lastName" type="text" class="form-control input-custom" formControlName="lastName"
              placeholder="Apellido">
            <div class="text-danger small"
              *ngIf="basicForm.get('lastName')?.invalid && basicForm.get('lastName')?.touched">
              {{ getErrorMessage(basicForm, 'lastName') }}
            </div>
          </div>

          <div class="mb-2">
            <label for="identification" class="form-label">Número de Identidad</label>
            <input id="identification" type="text" class="form-control input-custom" formControlName="identification"
              placeholder="Número de Identidad">
            <div class="text-danger small"
              *ngIf="basicForm.get('identification')?.invalid && basicForm.get('identification')?.touched">
              {{ getErrorMessage(basicForm, 'identification') }}
            </div>
          </div>

          <div class="d-flex justify-content-between mt-3">
            <button type="button" class="btn btn-outline-secondary" (click)="prevStep()">Volver</button>
            <button type="button" class="btn btn-success btn-custom" (click)="nextStep()"
              [disabled]="basicForm.invalid">
              Siguiente
            </button>
          </div>
        </form>

        <!-- Paso 3: Contacto y ubicación -->
        <form [formGroup]="contactForm" *ngIf="currentStep === 3">
          <div class="mb-2">
            <label for="phoneNumber" class="form-label">Número de Teléfono</label>
            <input id="phoneNumber" type="tel" class="form-control input-custom" formControlName="phoneNumber"
              placeholder="Número de Teléfono">
            <div class="text-danger small"
              *ngIf="contactForm.get('phoneNumber')?.invalid && contactForm.get('phoneNumber')?.touched">
              {{ getErrorMessage(contactForm, 'phoneNumber') }}
            </div>
          </div>

          <div class="mb-2">
            <label for="address" class="form-label">Dirección</label>
            <input id="address" type="text" class="form-control input-custom" formControlName="address"
              placeholder="Dirección">
            <div class="text-danger small"
              *ngIf="contactForm.get('address')?.invalid && contactForm.get('address')?.touched">
              {{ getErrorMessage(contactForm, 'address') }}
            </div>
          </div>

          <div class="mb-2 d-flex gap-2">
            <div class="flex-fill">
              <label for="departmentId" class="form-label">Departamento</label>
              <select id="departmentId" class="form-select input-custom" formControlName="departmentId">
                <option value="">Selecciona un departamento</option>
                <option *ngFor="let dept of departments" [value]="dept.id">{{ dept.name }}</option>
              </select>
            </div>
            <div class="flex-fill">
              <label for="cityId" class="form-label">Ciudad</label>
              <select id="cityId" class="form-select input-custom" formControlName="cityId">
                <option value="">Selecciona una ciudad</option>
                <option *ngFor="let city of cities" [value]="city.id">{{ city.name }}</option>
              </select>
            </div>
          </div>

          <div class="d-flex justify-content-between mt-3">
            <button type="button" class="btn btn-outline-secondary" (click)="prevStep()">Volver</button>
            <button type="button" class="btn btn-success btn-custom" (click)="register()"
              [disabled]="contactForm.invalid">
              Registrarse
            </button>
          </div>
        </form>

      </div>
    </div>
  </div>
</div>